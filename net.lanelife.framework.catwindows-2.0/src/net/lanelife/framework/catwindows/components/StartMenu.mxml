<?xml version="1.0" encoding="utf-8"?>
<s:SkinnableContainer xmlns:fx="http://ns.adobe.com/mxml/2009" 
					  xmlns:s="library://ns.adobe.com/flex/spark" 
					  xmlns:mx="library://ns.adobe.com/flex/mx"
					  creationComplete="init(event)">
	<fx:Script>
		<![CDATA[
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			import mx.rpc.events.ResultEvent;
			
			
			[Bindable]
			public var menuServiceUrl:String;
			
			
			[Bindable]
			public var startMenuButtons:ArrayCollection = new ArrayCollection();
			
			
			protected function init(event:FlexEvent):void
			{
				this.addEventListener(MouseEvent.MOUSE_OVER,function(e:MouseEvent):void{
					StartButton.display = true;
				});
				this.addEventListener(MouseEvent.MOUSE_OUT,function(e:MouseEvent):void{
					StartButton.display = false;
				});
				
				menuService.send();
			}
			
			protected function menuService_resultHandler(event:ResultEvent):void
			{
				var ac:ArrayCollection = event.result.item;
				
				for(var i:Number=0; i<ac.length; i++)
				{
					var button:StartMenuButton = new StartMenuButton();
					button.label = ac[i].name;
					button.moduleUrl = ac[i].module;
					
					button.doubleClickEnabled = true;
					button.addEventListener(MouseEvent.CLICK, menuButton_clickHandler);
					
					startMenuButtons.addItem(button);
					
				}
			}
			
			private function menuButton_clickHandler(event:MouseEvent):void
			{
				//var button:StartMenuButton = event.target as StartMenuButton;
				//var application:Application = new Application();
				//application.name = button.label;
				//application.moduleUrl = button.moduleUrl;
				//application.run();
				dispatchEvent(new Event("hiddenStartMenu"));
			}
			
		]]>
	</fx:Script>
	<fx:Metadata>
		[Event(name="hiddenStartMenu", type="flash.events.Event")]
	</fx:Metadata>
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
		<s:HTTPService id="menuService" url="{menuServiceUrl}" result="menuService_resultHandler(event)"/>
	</fx:Declarations>
</s:SkinnableContainer>
